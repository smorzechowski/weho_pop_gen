#!/bin/bash
#SBATCH -p shared,edwards
#SBATCH -n 1
#SBATCH -N 1
#SBATCH --mem 180G
#SBATCH -t 3-00:00
#SBATCH -J gGVCF
#SBATCH -o log/gGVCF_%A_%a.out
#SBATCH -e log/gGVCF_%A_%a.err
#SBATCH --array=11-15
#SBATCH --account=wakeley_lab

RMDIR='/n/holyscratch01/edwards_lab/smorzechowski/meliphagid/analysis/2024-08-12/08-repeatmasker'
OUTDIR='/n/holyscratch01/edwards_lab/smorzechowski/meliphagid/analysis/2024-08-12/13-gatk'
BAMDIR='/n/holyscratch01/edwards_lab/smorzechowski/meliphagid/analysis/2024-08-12/12-bwa/dedup_flag'
REFDIR='/n/holylfs04/LABS/edwards_lab/Lab/smorzechowski/meliphagid/ReferenceAssemblies'

export PATH="/n/home09/smorzechowski/bin/gatk-4.6.0.0/gatk/:$PATH"
module purge
module load python
module load jdk/20.0.1-fasrc01

/n/home09/smorzechowski/bin/gatk-4.6.0.0/gatk --java-options "-Xmx100G -Xms100G" \
GenotypeGVCFs \
-R $REFDIR/Nleucotis_hifi_v1.0_hc_sm_fx_scaffolded_PAR_masked.fasta \
-all-sites \
-L $REFDIR/Nleucotis_hifi_v1.0_hc_sm_fx_scaffolded_PAR_masked.fasta_1_"${SLURM_ARRAY_TASK_ID}".intervals \
-XL $RMDIR/Nleu_final_genome_softmask/rm_interval_1_clean.bed \
-V gendb:///n/holyscratch01/edwards_lab/smorzechowski/meliphagid/analysis/2024-08-12/13-gatk/gDBI_1_old \
-O $OUTDIR/Results/Nleu_interval_1_"${SLURM_ARRAY_TASK_ID}".allsites.partial.vcf \
