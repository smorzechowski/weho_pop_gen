#!/bin/bash

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_35_RagTag.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_35_test.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/testing_scaff_35_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='scaffold_35'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/Nleu_newPAR_rm_filt.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_newPAR_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_newPAR_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='newPAR_'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/Nleu_neoZ_males_rm_filt.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_males_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_males_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='neoZ_males_'

# sbatch local_pcangds.jobscript $input $store $zarr $tmp $prefix

# run local_pcangsd on separated autosomes larger than 200kb for all individuals
# test first!
# beagle_files_for_local_pcangsd.txt contains the header added files minus scaffold_1
# beagle_list_for_local_pcangsd.txt contains the test

# This isn't working -- need to run one at a time
#cat beagle_files_for_local_pcangsd.txt | while read line
#do
#prefix=`echo $line |sed 's/_header.beagle.gz//g'`
#input="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/$line"
#store="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/zarr_dir/${prefix}.zarr"
#zarr="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/${prefix}_results.zarr"
#tmp="/n/home09/smorzechowski/tmp_local_pcangsd"
#sbatch local_pcangsd.jobscript $input $store $zarr $tmp $prefix
#done

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_4_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_4_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_4_RagTag_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='scaffold_4_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=1
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_6_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_6_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_6_RagTag_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='scaffold_6_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=2
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_8_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_8_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_8_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_local_pcangsd'
#prefix='scaffold_8_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=2
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_9_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_9_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_9_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_local_pcangsd'
#prefix='scaffold_9_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=0
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_13_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_13_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_13_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_local_pcangsd'
#prefix='scaffold_13_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=0
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_7_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_7_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_7_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_local_pcangsd'
#prefix='scaffold_7_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=2
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_14_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_14_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_14_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_14_local_pcangsd'
#prefix='scaffold_14_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=1
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_16_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_16_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_16_RagTag_rm_filt_results.zarr'
#tmp='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/tmp_16_local_pcangsd'
#prefix='scaffold_16_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=0
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/scaffold_4_RagTag_rm_filt_header.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_4_RagTag_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/scaffold_4_RagTag_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='scaffold_4_test'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=0
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/all_samples_pops.tsv'
#wind=50000
#var=500

# Run just the arid males just to see what happens

#input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/Nleu_neoZ_arid_males_rm_filt.beagle.gz'
#store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_arid_males_rm_filt.zarr'
#zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_arid_males_rm_filt_results.zarr'
#tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
#prefix='Nleu_neoZ_arid_males'
#outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
#col=0
#pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/arid_male_pops.tsv'
#wind=50000
#var=500

# Run just the temperate males just to see what happens

input='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/14-angsd/results/Nleu_neoZ_temperate_males_rm_filt.beagle.gz'
store='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_temperate_males_rm_filt.zarr'
zarr='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/results/Nleu_neoZ_temperate_males_rm_filt_results.zarr'
tmp='/n/home09/smorzechowski/tmp_local_pcangsd'
prefix='Nleu_neoZ_temperate_males'
outdir="/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/plots/"
col=0
pop='/n/netscratch/edwards_lab/Lab/smorzechowski/meliphagid/analysis/2024-11-03/16-local_pcangsd/temperate_male_pops.tsv'
wind=50000
var=500


sbatch local_pcangsd.jobscript $input $store $zarr $tmp $prefix $outdir $col $pop $wind $var

